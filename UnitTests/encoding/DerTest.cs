using Jose;
using Xunit;

namespace UnitTests.encoding
{
    public class DerTest
    {
        [Fact]
        public void ToP1363()
        {
            //given
            var asn1Signature = new byte[] { 48, 69, 2, 32, 107, 220, 182, 187, 167, 215, 168, 250, 93, 197, 247, 235, 17, 172, 45, 150, 127, 109, 119, 122, 28, 25, 145, 153, 224, 187, 81, 224, 27, 247, 63, 46, 2, 33, 0, 133, 195, 151, 2, 56, 255, 238, 132, 63, 107, 113, 240, 18, 31, 159, 102, 106, 181, 142, 121, 156, 33, 53, 65, 223, 116, 116, 55, 214, 216, 243, 90 };
            var p1363Signature = new byte[] { 107, 220, 182, 187, 167, 215, 168, 250, 93, 197, 247, 235, 17, 172, 45, 150, 127, 109, 119, 122, 28, 25, 145, 153, 224, 187, 81, 224, 27, 247, 63, 46, 133, 195, 151, 2, 56, 255, 238, 132, 63, 107, 113, 240, 18, 31, 159, 102, 106, 181, 142, 121, 156, 33, 53, 65, 223, 116, 116, 55, 214, 216, 243, 90 };
            
            //when
            var test = Der.ToP1363(asn1Signature);

            //then
            Assert.Equal(p1363Signature, test);
        }
        
        [Fact]
        public void ToASN1()
        {
            //given
            var p1363Signature = new byte[] { 107, 220, 182, 187, 167, 215, 168, 250, 93, 197, 247, 235, 17, 172, 45, 150, 127, 109, 119, 122, 28, 25, 145, 153, 224, 187, 81, 224, 27, 247, 63, 46, 133, 195, 151, 2, 56, 255, 238, 132, 63, 107, 113, 240, 18, 31, 159, 102, 106, 181, 142, 121, 156, 33, 53, 65, 223, 116, 116, 55, 214, 216, 243, 90 };
            var asn1Signature = new byte[] { 48, 69, 2, 32, 107, 220, 182, 187, 167, 215, 168, 250, 93, 197, 247, 235, 17, 172, 45, 150, 127, 109, 119, 122, 28, 25, 145, 153, 224, 187, 81, 224, 27, 247, 63, 46, 2, 33, 0, 133, 195, 151, 2, 56, 255, 238, 132, 63, 107, 113, 240, 18, 31, 159, 102, 106, 181, 142, 121, 156, 33, 53, 65, 223, 116, 116, 55, 214, 216, 243, 90 };
            
            //when
            var test = Der.ToASN1(p1363Signature);

            //then
            Assert.Equal(asn1Signature, test);
        }
    }
}